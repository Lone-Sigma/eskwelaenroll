<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Enrollment Form</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      /* --- GLOBAL STYLES & VARIABLES (Light Mode with Green/Teal Palette) --- */
      :root {
        /* Base Colors - Adjusted for Light Mode */
        --primary: #007769; /* Dark Teal Green */
        --primary-light: #00b4a5; /* Bright Teal */
        --secondary: #38a3a5; /* Mid Teal */
        --danger: #ef476f;
        --dark: #2d3748; /* Dark text/headers */
        --light: #ffffff; /* Card/Surface white */
        --border: #e9ecef;
        --text: var(--dark); /* Main text color (Dark) */
        --text-light: #718096; /* Light gray text/labels */
        --shadow-lg: 0 5px 15px rgba(0, 0, 0, 0.08); /* Flatter shadow for modern UI */
        --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        --radius: 12px; /* Slightly larger radius */
        --radius-sm: 8px;
        --transition: all 0.3s ease;

        /* Background Colors (Light Theme) */
        --bg-start: #f5f7fa; /* Very Light Gray */
        --bg-end: #ffffff; /* White */
        --accent-color: #57cc99; /* Light Mint/Accent Green */
        
        /* Custom Colors for Upload Box (UPDATED TO GREEN/TEAL) */
        --upload-border: var(--primary-light); /* Bright Teal/Green */
        --upload-bg: #e6f9f7; /* Very light teal background */
        --upload-icon: var(--primary); /* Dark Teal Green */
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      body {
        /* Light mode background gradient */
        background: linear-gradient(
          135deg,
          var(--bg-start) 0%,
          var(--bg-end) 100%
        );
        color: var(--text); /* Dark text on light background */
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        position: relative;
        overflow-x: hidden;
      }

      /* --- HEADER STYLES --- */
      .header {
        background-color: var(--light);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        padding: 15px 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 100;
      }

      .logo a {
        font-size: 28px;
        font-weight: 800;
        color: var(--dark);
        text-decoration: none;
        letter-spacing: -1px;
        display: flex;
        align-items: center;
      }
      
      .logo-icon {
        font-size: 32px;
        margin-right: 10px;
        color: var(--primary);
        text-shadow: 
            1px 1px 0 var(--secondary),
            2px 2px 0 var(--primary-light),
            3px 3px 5px rgba(0, 0, 0, 0.3); 
        transition: transform 0.3s ease;
      }
      
      .logo a:hover .logo-icon {
          transform: scale(1.05);
      }

      .logo a:hover {
          color: var(--primary);
      }

      .nav-links {
        display: flex;
        gap: 20px;
        align-items: center;
      }
      
      .nav-links a.nav-link {
        color: var(--text-light); 
        text-decoration: none;
        font-weight: 500;
        transition: color var(--transition);
        padding: 5px 0;
        position: relative;
        font-size: 14px;
      }
      
      .nav-links a.nav-link:hover {
          color: var(--dark);
      }
      
      .nav-links a.nav-link.active {
          color: var(--primary);
          font-weight: 600;
      }
      .nav-links a.nav-link:after {
          content: "";
          position: absolute;
          width: 0;
          height: 2px;
          display: block;
          margin-top: 5px;
          background: var(--accent-color);
          transition: width var(--transition);
          left: 50%;
          transform: translateX(-50%);
      }

      .nav-links a.nav-link.active:after,
      .nav-links a.nav-link:hover:after {
          width: 100%;
      }

      .btn {
        padding: 8px 18px;
        border-radius: var(--radius-sm);
        text-decoration: none;
        font-weight: 600;
        transition: var(--transition);
        border: 1px solid transparent;
        font-size: 14px;
        cursor: pointer;
        box-shadow: var(--shadow);
        text-align: center;
      }

      .btn-outline {
        color: var(--dark);
        border-color: var(--border);
        background-color: transparent;
      }

      .btn-outline:hover {
        background-color: var(--border);
        border-color: var(--text-light);
      }

      .btn-primary {
        background: linear-gradient(
          90deg,
          var(--accent-color) 0%,
          var(--primary-light) 100%
        );
        color: var(--dark);
        border: none;
        box-shadow: 0 4px 15px rgba(87, 204, 153, 0.4);
      }

      .btn-primary:hover {
        background: linear-gradient(
          90deg,
          var(--primary-light) 0%,
          var(--accent-color) 100%
        );
        box-shadow: 0 6px 20px rgba(87, 204, 153, 0.6);
        transform: translateY(-2px);
      }

      /* --- MAIN CONTENT & FORM STYLES --- */

      .form-container {
        flex-grow: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px 20px;
      }

      .card {
        background-color: var(--light);
        padding: 50px; 
        border-radius: var(--radius);
        box-shadow: var(--shadow-lg); 
        max-width: 900px; 
        width: 100%;
        text-align: center;
        transition: var(--transition);
      }

      .card h2 {
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 5px;
        color: var(--primary);
      }

      .card > p { /* Target direct children <p> */
        color: var(--text-light);
        margin-bottom: 30px;
        font-size: 15px;
        font-weight: 600;
      }
      
      /* --- TWO-COLUMN GRID IMPLEMENTATION --- */
      .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr; /* Two equal columns */
        gap: 40px; /* Spacing between columns */
        margin-bottom: 30px;
        position: relative;
        text-align: left;
      }
      
      /* Subtle Vertical Divider - REMOVED AS REQUESTED */
      .form-grid::after {
          display: none; 
      }
      
      /* Section Title for the columns */
      .section-title-col {
          font-size: 14px; 
          font-weight: 700;
          color: var(--primary-light);
          text-transform: uppercase;
          margin-bottom: 20px;
          letter-spacing: 0.5px;
          border-bottom: 2px solid var(--border);
          padding-bottom: 8px;
          margin-top: 10px;
      }
      
      /* For required documents section to take full width */
      .full-width-section {
          grid-column: 1 / -1;
      }
      
      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        font-size: 14px;
        font-weight: 500;
        color: var(--dark);
        margin-bottom: 6px;
      }
      
      .form-group input:not([type="radio"]):not([type="checkbox"]), 
      .form-group select { /* ADDED SELECT */
        width: 100%;
        padding: 12px;
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        font-size: 16px;
        color: var(--dark);
        transition: border-color var(--transition), box-shadow var(--transition);
        background-color: #fcfcfc;
        /* Select specific styling */
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
      }

      #relationship {
        background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007769%22%20d%3D%22M287%2069.9L146.4%20205.1l-140-135.2c-5.7-5.5-14.8-5.5-20.5%200-5.7%205.5-5.7%2014.5%200%2020L135.8%20216.7c5.7%205.5%2014.8%205.5%2020.5%200l130.7-126.8c5.7-5.5%205.7-14.5%200-20z%22%2F%3E%3C%2Fsvg%3E");
        background-repeat: no-repeat;
        background-position: right 0.7em top 50%;
        background-size: 0.65em auto;
      }

      .form-group input:not([type="radio"]):not([type="checkbox"]):focus,
      .form-group select:focus { /* ADDED SELECT */
        border-color: var(--primary-light);
        outline: none;
        box-shadow: 0 0 0 3px rgba(87, 204, 153, 0.3);
      }
      
      /* Horizontal Field Grouping for smaller items like DoB and Contact */
      .input-row {
          display: flex;
          gap: 20px;
      }
      .input-row .form-group {
        flex: 1;
      }

      /* --- CUSTOM RADIO/CHECKBOX STYLES (for GENDER & GRADE) --- */
      .radio-selection {
        display: flex;
        gap: 10px;
        margin-top: 5px;
      }
      
      /* Grade Level Selection - Grid for 5-6 options */
      .grade-selection-grid {
          display: grid;
          grid-template-columns: repeat(6, 1fr);
          gap: 5px;
          margin-top: 10px;
      }
      
      .grade-selection-grid.elementary {
          grid-template-columns: repeat(5, 1fr);
      }
      
      .custom-radio input[type="radio"] {
        display: none;
      }

      .custom-radio label {
        display: block;
        padding: 10px 5px;
        background-color: var(--bg-end);
        border: 1px solid var(--border); 
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: var(--transition);
        font-weight: 500;
        color: var(--text-light);
        font-size: 13px;
        text-align: center;
        text-transform: uppercase;
        white-space: nowrap;
      }
      
      /* Adjusted label for small grade numbers */
      .grade-selection-grid .custom-radio label {
          padding: 8px 3px;
          font-size: 12px;
      }

      .custom-radio input[type="radio"]:checked + label {
        background-color: var(--accent-color);
        border-color: var(--primary);
        color: var(--dark);
        box-shadow: 0 2px 5px rgba(87, 204, 153, 0.3); 
      }
      
      /* --- GOOGLE DRIVE LINK STYLES --- */
      .google-drive-instruction-box {
          border: 1px solid var(--primary-light);
          border-radius: var(--radius-sm);
          background-color: var(--upload-bg); /* Use light teal background */
          padding: 15px;
          margin-bottom: 20px;
          text-align: left;
      }
      .google-drive-instruction-box h4 {
          font-size: 14px;
          color: var(--primary);
          font-weight: 700;
          margin-bottom: 5px;
          display: flex;
          align-items: center;
      }
      .google-drive-instruction-box h4 i {
          margin-right: 8px;
          font-size: 16px;
      }
      .google-drive-instruction-box ul {
          list-style: none;
          padding-left: 0;
          margin-top: 10px;
      }
      .google-drive-instruction-box ul li {
          font-size: 13px;
          color: var(--dark);
          line-height: 1.6;
          padding-left: 20px;
          position: relative;
      }
      .google-drive-instruction-box ul li:before {
          content: "\f058"; /* Checkmark icon */
          font-family: 'Font Awesome 6 Free';
          font-weight: 900;
          position: absolute;
          left: 0;
          color: var(--primary);
      }
      .google-drive-instruction-box p.access-note {
          margin-top: 10px;
          font-size: 12px;
          font-weight: 600;
          color: var(--danger);
          padding: 5px 0;
          border-top: 1px dashed var(--border);
      }
      /* End of Google Drive Link Styles */

      .form-actions {
        grid-column: 1 / -1;
        margin-top: 30px;
      }

      .form-actions button {
        width: 100%;
        padding: 15px; /* Increased padding for main button */
        font-size: 18px; /* Increased font size */
        font-weight: 700;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: var(--transition);
        border: none;
      }
      
      /* Button specific styles for primary button */
      .form-actions button.btn-primary {
          color: var(--light); /* White text on Enroll Button */
          background: linear-gradient(
          90deg,
          var(--primary) 0%,
          var(--primary-light) 100%
        );
        box-shadow: 0 4px 15px rgba(0, 119, 105, 0.4);
      }
      
      .form-actions button.btn-primary:hover {
          background: linear-gradient(
          90deg,
          var(--primary-light) 0%,
          var(--primary) 100%
        );
      }
      
      .form-status {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(255, 255, 255, 0.9);
          display: none;
          justify-content: center;
          align-items: center;
          flex-direction: column;
          z-index: 10000;
          font-size: 20px;
          color: var(--primary);
          text-align: center;
      }
      
      .form-status.active {
          display: flex;
      }
      
      .loader {
          border: 6px solid var(--border);
          border-top: 6px solid var(--primary-light);
          border-radius: 50%;
          width: 50px;
          height: 50px;
          animation: spin 1s linear infinite;
          margin-bottom: 15px;
      }
      
      .message-box {
        background-color: var(--light);
        padding: 25px;
        border-radius: var(--radius);
        box-shadow: var(--shadow-lg);
        max-width: 400px;
        width: 90%;
        text-align: center;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 10001;
        display: none; /* Controlled by JS */
        border-top: 5px solid var(--danger); /* default: error red */
      }

      .message-box.show {
        display: block;
      }

      .message-box h3 {
        color: var(--danger);
        margin-bottom: 10px;
      }

      .message-box p {
        color: var(--dark);
        margin-bottom: 20px;
        font-size: 15px;
      }

      /* ✅ Success message styling */
      .message-box.success {
        border-top: 5px solid var(--success); /* green border */
      }

      .message-box.success h3 {
        color: var(--success); /* green title text */
      }

      .message-box.success button {
        background-color: var(--success);
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .message-box.success button:hover {
        background-color: #3da75c; /* slightly darker green on hover */
      }


      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }


      /* --- MEDIA QUERIES --- */
      @media (max-width: 900px) { 
        .form-grid {
            grid-template-columns: 1fr; /* Single column on tablet/mobile */
            gap: 20px;
        }
        .form-grid::after {
            display: none; /* Hide vertical divider on mobile to fix potential overlap */
        }
        .card {
            max-width: 100%;
            padding: 30px 20px;
        }
        .section-title-col {
            margin-top: 0;
        }
      }

      @media (max-width: 600px) {
        .header {
          flex-direction: column;
          gap: 15px;
          padding: 15px 20px;
        }
        .nav-links {
            width: 100%;
            justify-content: space-around;
        }
        .logo a {
            font-size: 20px;
        }
        .logo-icon {
            font-size: 24px;
        }
        .card h2 {
            font-size: 24px;
        }
        .btn, .nav-links a {
            flex-grow: 1;
            text-align: center;
        }
        .input-row {
            flex-direction: column;
            gap: 0;
        }
        .grade-selection-grid {
            grid-template-columns: repeat(3, 1fr); /* 3 columns for grades on small screens */
        }
      }
    </style>
  </head>
  <body>
    <div id="error-message-box" class="message-box">
      <h3>Submission Error</h3>
      <p id="error-message-text"></p>
      <button class="btn btn-outline" onclick="closeMessageBox()">Close</button>
    </div>

    <!-- ✅ Success Message Box -->
    <div id="success-message-box" class="message-box success">
      <h3>Success</h3>
      <p id="success-message-text">Enrollment submitted successfully!</p>
      <button onclick="continueToHome()">Continue</button>
    </div>

    <div id="loading-overlay" class="form-status">
      <div class="loader"></div>
      <p id="loading-text">Submitting your enrollment... Please wait.</p>
    </div>

    <header class="header">
      <div class="logo">
        <a href="#" id="logo-home">
          <i class="fas fa-clipboard-list logo-icon"></i>
          eSkwelaEnroll
        </a>
      </div>
      <nav class="nav-links" id="main-nav">
        <a href="home.html" class="nav-link" id="nav-home">Home</a>
        <a href="#" class="nav-link active" id="btn-enroll">Enrollment</a>
      </nav>
    </header>

    <main class="form-container">
      <div class="card">
        <h2>Student Registration</h2>
        <p>Please complete all sections to successfully enroll the student.</p>

        <form id="enrollment-form">
          <div class="form-grid">
            
            <div class="section-column student-info">

              <div class="section-title-col">PERSONAL INFORMATION</div>

              <!-- ✅ Transferee Dropdown -->
              <div class="form-group">
                <label for="transferee">Are you a transferee?</label>
                  <select id="transferee" required>
                    <option value="">Select</option>
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                  </select>
              </div>
              
              <!-- ✅ Student ID -->
              <div class="form-group">
                <label for="student-id">Student ID:</label>
                <input type="text" id="student-id" placeholder="Enter Student ID" required />
              </div>

              <div class="form-group">
                <label for="first-name">FIRST NAME</label>
                <input type="text" id="first-name" placeholder="Enter your first name" required />
              </div>

              <div class="form-group">
                <label for="middle-name">MIDDLE NAME</label>
                <input type="text" id="middle-name" placeholder="Enter your middle name" />
              </div>

              <div class="form-group">
                <label for="last-name">LAST NAME</label>
                <input type="text" id="last-name" placeholder="Enter your last name" required />
              </div>
              
              <div class="input-row">
                <div class="form-group">
                  <label for="dob">DATE OF BIRTH</label>
                  <input type="date" id="dob" required />
                  <p style="font-size:12px; color:var(--text-light); margin-top: 5px;">mm-dd-yyyy</p>
                </div>

                <div class="form-group">
                  <label for="gender">GENDER</label>
                  <select id="gender" required>
                      <option value="">-- Select Gender --</option>
                      <option value="Male">Male</option>
                      <option value="Female">Female</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="address">ADDRESS</label>
                <input type="text" id="address" placeholder="Enter valid address" required />
              </div>

              <div class="form-group">
                <label for="contact-number">CONTACT NUMBER</label>
                <input type="tel" id="contact-number" placeholder="Enter valid contact number" required />
              </div>

            </div>

            <div class="section-column guardian-info">
              <div class="section-title-col">GUARDIAN INFORMATION</div>

              <div class="form-group">
                <label for="guardian-name">FULL NAME</label>
                <input type="text" id="guardian-name" placeholder="Enter full name" required />
              </div>
              
              <div class="form-group">
                <label for="relationship">RELATIONSHIP</label>
                <select id="relationship" required>
                    <option value="">-- Select Relationship --</option>
                    <option value="Mother">Mother</option>
                    <option value="Father">Father</option>
                    <option value="LegalGuardian">Legal Guardian</option>
                    <option value="Grandparent">Grandparent</option>
                    <option value="Sibling">Sibling</option>
                    <option value="Other">Other Relative</option>
                </select>
              </div>

              <div class="form-group">
                <label for="guardian-contact">CONTACT NUMBER</label>
                <input type="tel" id="guardian-contact" placeholder="Enter your contact number" required />
              </div>
              
              <div class="form-group">
                <label for="guardian-address">ADDRESS</label>
                <input type="text" id="guardian-address" placeholder="Enter valid address" required />
              </div>
              
              <div class="section-title-col" style="margin-top: 30px;">EDUCATIONAL INFORMATION</div>
              
              <div class="form-group">
                <label>INTENDED GRADE LEVEL</label>
                <div class="grade-selection-grid">
                    <div class="custom-radio"><input type="radio" id="k1" name="grade" value="K-1" required><label for="k1">K1</label></div>
                    <div class="custom-radio"><input type="radio" id="k2" name="grade" value="K-2"><label for="k2">K2</label></div>
                    <div class="custom-radio"><input type="radio" id="e1" name="grade" value="E-1"><label for="e1">1</label></div>
                    <div class="custom-radio"><input type="radio" id="e2" name="grade" value="E-2"><label for="e2">2</label></div>
                    <div class="custom-radio"><input type="radio" id="e3" name="grade" value="E-3"><label for="e3">3</label></div>
                    <div class="custom-radio"><input type="radio" id="e4" name="grade" value="E-4"><label for="e4">4</label></div>
                </div>
                <div class="grade-selection-grid elementary" style="margin-top: 10px;">
                    <div class="custom-radio"><input type="radio" id="e5" name="grade" value="E-5"><label for="e5">5</label></div>
                    <div class="custom-radio"><input type="radio" id="e6" name="grade" value="E-6"><label for="e6">6</label></div>
                </div>
              </div>
              
            </div>
            
            <div class="full-width-section">
                <div class="section-title-col">REQUIRED DOCUMENTS (GOOGLE DRIVE LINK)</div>
                
                <div class="google-drive-instruction-box">
                    <h4><i class="fas fa-folder-open"></i> Document Submission Instructions</h4>
                    <p>Please upload all required documents into a single folder in your Google Drive, then share the link below. </p>
                    <ul>
                        <li>Upload a folder containing:
                            <ul>
                                <li><strong>Birth Certificate</strong></li>
                                <li><strong>Report Card / Form 138</strong></li>
                                <li><strong>Good Moral Certificate</strong> (if a transferee)</li>
                            </ul>
                        </li>
                        <li>Crucial: The folder link **MUST BE ACCESSIBLE** to anyone with the link ("Viewer" access).</li>
                    </ul>
                    <p class="access-note"><i class="fas fa-exclamation-triangle"></i> Enrollment will be delayed if the link is inaccessible or documents are incomplete.</p>
                </div>
                
                <div class="form-group">
                    <label for="drive-link">GOOGLE DRIVE FOLDER LINK (Shared)</label>
                    <input type="url" id="drive-link" placeholder="e.g., https://drive.google.com/drive/folders/xxxxxxxxxxxxxxxx" required />
                </div>

            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary" id="submit-btn">
                <i class="fas fa-file-signature"></i> Submit Enrollment
              </button>
            </div>
          </div>
        </form>
        
        <div class="link-text">
            * By submitting this form, you agree to the privacy policy.
        </div>
      </div>
    </main>

    <script type="module">
      // ✅ Import Firebase SDKs
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js";
      import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

      // ✅ Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBhkOB7czk7j2qqDiOpWGnlS0ICedOtOtk",
        authDomain: "eskwelaenroll.firebaseapp.com",
        databaseURL: "https://eskwelaenroll-default-rtdb.firebaseio.com/",
        projectId: "eskwelaenroll",
        storageBucket: "eskwelaenroll.firebasestorage.app",
        messagingSenderId: "20006672415",
        appId: "1:20006672415:web:667c119d184e7150429d2a",
        measurementId: "G-DNKL014SDS"
      };

      // ✅ Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      const auth = getAuth(app);

      // ✅ Anonymous Sign-In
      signInAnonymously(auth)
        .then(() => console.log("Signed in anonymously"))
        .catch((error) => console.error("Auth Error:", error));

      // ✅ Helper: Show/Hide loader
      function toggleLoading(show, text = "Submitting your enrollment... Please wait.") {
        const overlay = document.getElementById("loading-overlay");
        const loadingText = document.getElementById("loading-text");
        if (show) {
          loadingText.textContent = text;
          overlay.classList.add("active");
        } else {
          overlay.classList.remove("active");
        }
      }

      // ✅ Helper: Show error message
      function showError(message) {
        const box = document.getElementById("error-message-box");
        const text = document.getElementById("error-message-text");
        text.textContent = message;
        box.classList.add("show");
      }

      // ✅ Helper: Show success message
      function showSuccess(message) {
        const box = document.getElementById("success-message-box");
        const text = document.getElementById("success-message-text");
        text.textContent = message;
        box.classList.add("show");
      }

      // ✅ Close message boxes
      window.closeMessageBox = function () {
        document.getElementById("error-message-box").classList.remove("show");
      };

      window.continueToHome = function () {
        document.getElementById("success-message-box").classList.remove("show");
        window.location.href = "success.html";
      };

      // ✅ Transferee Logic (Disable Student ID if Yes)
      const transfereeSelect = document.getElementById("transferee");
      const studentIdInput = document.getElementById("student-id");

      transfereeSelect.addEventListener("change", () => {
        if (transfereeSelect.value === "Yes") {
          studentIdInput.value = "N/A";
          studentIdInput.disabled = true;
        } else {
          studentIdInput.value = "";
          studentIdInput.disabled = false;
        }
      });

      // ✅ Handle form submission
      document.getElementById("enrollment-form").addEventListener("submit", async (e) => {
        e.preventDefault();
        toggleLoading(true);

        try {
          // ✅ Collect form values
          const student = {
            studentId: document.getElementById("student-id").value.trim(),
            transferee: document.getElementById("transferee").value,
            firstName: document.getElementById("first-name").value.trim(),
            middleName: document.getElementById("middle-name").value.trim(),
            lastName: document.getElementById("last-name").value.trim(),
            dob: document.getElementById("dob").value,
            gender: document.getElementById("gender").value,
            address: document.getElementById("address").value.trim(),
            contactNumber: document.getElementById("contact-number").value.trim(),
            intendedGrade: document.querySelector("input[name='grade']:checked")?.value || "",
            driveLink: document.getElementById("drive-link").value.trim(),
            status: "Pending" // 👈 Automatically set status
          };

          const guardian = {
            fullName: document.getElementById("guardian-name").value.trim(),
            relationship: document.getElementById("relationship").value,
            contactNumber: document.getElementById("guardian-contact").value.trim(),
            address: document.getElementById("guardian-address").value.trim()
          };

          // ✅ Basic validation
          if (
            !student.transferee ||
            (!studentIdInput.disabled && !student.studentId) ||
            !student.firstName ||
            !student.lastName ||
            !student.dob ||
            !student.gender ||
            !student.intendedGrade ||
            !guardian.fullName ||
            !guardian.relationship
          ) {
            toggleLoading(false);
            showError("Please fill in all required fields before submitting.");
            return;
          }

          // ✅ Structure to save
          const enrollmentData = {
            timestamp: new Date().toISOString(),
            student,
            guardian
          };

          // ✅ Save to Realtime Database
          const newRef = push(ref(db, "enrollments"));
          await set(newRef, enrollmentData);

          // ✅ Reset form
          document.getElementById("enrollment-form").reset();
          transfereeSelect.value = "";
          studentIdInput.disabled = false;

          // ✅ Hide loading and show success
          toggleLoading(false);
          showSuccess("🎉 Enrollment submitted successfully! Your status is now 'Pending'.");

        } catch (error) {
          console.error("Error submitting form:", error);
          toggleLoading(false);
          showError("An error occurred while submitting the form. Please try again.");
        }
      });
    </script>



  </body>
</html>